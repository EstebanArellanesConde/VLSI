LIBRARY IEEE;
USE IEEE.STD_LOGIC_1164.ALL;
USE IEEE.NUMERIC_STD.ALL;

ENTITY CaF IS 
	PORT(CUENTAS: IN STD_LOGIC_VECTOR(11 DOWNTO 0);
		  UNIT: OUT STD_LOGIC_VECTOR(7 DOWNTO 0);
	     C, D, U: OUT INTEGER;
		  FSM: IN STD_LOGIC);
END ENTITY;

ARCHITECTURE BEAS OF CaF IS
	SIGNAL TC, TF, UC, DC, CC, UF, DF, CF, Vx: INTEGER;

BEGIN
	
	Vx <= (5 * to_integer(unsigned(CUENTAS))) / 4095;
	TC<=100*Vx;
	TF <= (9 * TC) / 5 + 32;
	
	UC <= TC mod 10;                 -- Unidades (correcto)
	DC <= (TC / 10) mod 10;          -- Decenas
	CC <= (TC / 100) mod 10;         -- Centenas

	UF <= TF mod 10;                 -- Unidades
	DF <= (TF / 10) mod 10;          -- Decenas
	CF <= (TF / 100) mod 10;         -- Centenas
	
	PROCESS(CUENTAS, FSM)
	BEGIN
		 
		 IF FSM = '0' THEN
			 C<=CC; D<=DC; U<=UC;
			 UNIT<="01100011";--C
		 ELSE
			 C<=CF; D<=DF; U<=UF;
			 UNIT<="01110001";--F
		 END IF;
		 
	END PROCESS;

END BEAS;